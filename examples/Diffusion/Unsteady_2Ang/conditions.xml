<?xml version="1.0" encoding="utf-8" ?>
<NEKTAR>
    <CONDITIONS>
        <PARAMETERS>
            <P> m_e            = 9.1096e-31        </P>
            <P> m_p            = 1.6726e-27        </P>
            <P> A              = 1.0               </P>
            <P> Z              = 1.0               </P>
            <P> m_i            = A*m_p             </P>
            <P> T_e            = 116050            </P>
            <P> T_i            = T_e               </P>
            <P> epsilon_0      = 8.8542e-12        </P>
            <P> e              = 1.6022e-19        </P>
            <P> k_B            = 1.3807e-23        </P>
            <P> lambda         = 13.0              </P>
            <P> theta          = 2.0               </P>
            <P> n              = 1e18              </P>
            <P> B              = 1.0               </P>
            <P> k_par          = 19.2 * sqrt(2.0 * PI^3.0) * (1.0/sqrt(m_e)) * (epsilon_0^2.0 / e^4.0) * (((k_B * T_e)^(5.0/2.0))/((Z^2.0) * lambda)) </P>
            <!--<P> k_perp         = 1.0/(6.0*sqrt(PI^3.0))*1.0/m_i*(n*Z*e/(B*epsilon_0))^2.0*((m_p*A)^1.5*lambda)/sqrt(k_B*T_i) </P>-->
            <P> k_perp         = 0.0               </P>
            <P> a              = 200.0             </P>
            <P> TimeStep       = 0.001             </P>
            <P> FinalTime      = 0.005             </P>
            <P> NumSteps       = FinalTime/TimeStep</P>
            <P> IO_CheckSteps  = 5                 </P>
            <P> IO_InfoSteps   = 5                 </P>
        </PARAMETERS>

        <SOLVERINFO>
            <I PROPERTY="EQTYPE"                VALUE="UnsteadyDiffusion"   />
            <I PROPERTY="Projection"            VALUE="Continuous"        />
            <I PROPERTY="GlobalSysSoln"         VALUE="XxtMultiLevelStaticCond"/>
            <!--<I PROPERTY="GlobalSysSoln"         VALUE="IterativeMultiLevelStaticCond" />-->
            <!--<I PROPERTY="GlobalSysSoln"         VALUE="IterativeFull"    />-->
            <I PROPERTY="TimeIntegrationMethod" VALUE="BDFImplicitOrder1"   />
        </SOLVERINFO>

        <GLOBALSYSSOLNINFO>
            <V VAR="u">
                <I PROPERTY="GlobalSysSoln"             VALUE="XxtMultiLevelStaticCond"/>
                <!--<I PROPERTY="GlobalSysSoln"         VALUE="IterativeMultiLevelStaticCond" />-->
                <!--<I PROPERTY="GlobalSysSoln"         VALUE="IterativeFull"    />-->
                <I PROPERTY="LinSysIterSolver"          VALUE="GMRES"/>
                <I PROPERTY="Preconditioner"            VALUE="Diagonal"        />
                <I PROPERTY="MaxIterations"             VALUE="1000"/>
                <I PROPERTY="GMRESMaxStorage"           VALUE=200       />
                <I PROPERTY="IterativeSolverTolerance"  VALUE="1e-3"/>
            </V>
        </GLOBALSYSSOLNINFO>

        <VARIABLES>
            <V ID="0"> u </V>
        </VARIABLES>

        <BOUNDARYREGIONS>
            <B ID="0"> C[2] </B>
            <B ID="1"> C[3] </B>
            <B ID="2"> C[4] </B>
            <B ID="3"> C[1] </B>
        </BOUNDARYREGIONS>

        <BOUNDARYCONDITIONS>
            <REGION REF="0">
                <N VAR="u" VALUE="0" />
            </REGION>
            <REGION REF="1">
                <N VAR="u" VALUE="0" />
            </REGION>
            <REGION REF="2">
                <N VAR="u" VALUE="0" />
            </REGION>
            <REGION REF="3">
                <D VAR="u" VALUE="0.5 + 0.5 * tanh(a*(y-77)) * tanh(a*(23-y))" />
            </REGION>
        </BOUNDARYCONDITIONS>

        <FUNCTION NAME="ExactSolution">
            <E VAR="u" VALUE="0.5 + 0.5 * tanh(a*(y-77+tan(2.0*PI/180.0)*x)) * tanh(a*(23-y-tan(2.0*PI/180.0)*x))"/>
        </FUNCTION>

        <FUNCTION NAME="InitialConditions">
            <E VAR="u" VALUE="0"/>
        </FUNCTION>

    </CONDITIONS>
</NEKTAR>
